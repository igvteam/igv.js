<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Seg Big</title>

</head>

<body>

<h1>Shoebox</h1>

<button id="log-state">Log Session</button>
<button id="bookmark">Bookmark</button>

<div id="igvDiv" style="padding-top: 50px;padding-bottom: 20px; height: auto"></div>

<script type="module">

    import igv from "../../js/index.js"

    var options =
        {
            sampleNameViewportWidth: 6,
            genome: "hg38",
            locus: "chr1:1,001,575-1,002,408",
            tracks: [
                {
                    "url": "https://www.dropbox.com/scl/fi/ayu63q7raqi47yduvvte5/pseudobulk_0.bed.gz?rlkey=ci5oqo928iljje4igk4wwjoor&dl=0",
                    "indexURL": "https://www.dropbox.com/scl/fi/bxz53av4v0ri9snidxj8g/pseudobulk_0.bed.gz.tbi?rlkey=qvc7zk8si0ays89cqjp05fdw9&dl=0",
                    //  visibilityWindow: 10000
                    //  "name": "pseudobulk 14",
                    //  "type": "shoebox",
                    //  "format": "shoebox"
                },
                {
                    "name": "Homo sapiens HepG2 H3K4me3 ",
                    "url": "https://www.encodeproject.org/files/ENCFF752OCZ/@@download/ENCFF752OCZ.bigWig",
                    "color": "rgb(0,150,0)",
                    "metadata": {
                        "Biosample": "Homo sapiens HepG2",
                        "AssayType": "ChIP-seq",
                        "Target": "H3K4me3 ",
                        "BioRep": "1",
                        "TechRep": "1_1",
                        "OutputType": "signal p-value",
                        "Format": "bigWig",
                        "Lab": "John Stamatoyannopoulos, UW",
                        "Accession": "ENCFF752OCZ",
                        "Experiment": "ENCSR000DUF"
                    },
                    "format": "bigwig",
                    "type": "wig"
                },
                {
                    "name": "Homo sapiens HepG2 CTCF ",
                    "url": "https://www.encodeproject.org/files/ENCFF160QOX/@@download/ENCFF160QOX.bigWig",
                    "metadata": {
                        "Biosample": "Homo sapiens HepG2",
                        "AssayType": "ChIP-seq",
                        "Target": "CTCF ",
                        "BioRep": "1",
                        "TechRep": "1_1",
                        "OutputType": "fold change over control",
                        "Format": "bigWig",
                        "Lab": "Richard Myers, HAIB",
                        "Accession": "ENCFF160QOX",
                        "Experiment": "ENCSR000BIE"
                    },
                    "format": "bigwig",
                    "type": "wig"
                }
            ]
        }


    var igvDiv = document.getElementById("igvDiv")

    igv.createBrowser(igvDiv, options)
        .then(function (browser) {
            console.log("Created IGV browser")
            document.getElementById("log-state").addEventListener("click", () => console.log(browser.toJSON()))

            document.getElementById('bookmark').addEventListener('click', () => {
                const path = window.location.href.slice()
                const idx = path.indexOf("?")
                const url = (idx > 0 ? path.substring(0, idx) : path) + "?sessionURL=blob:" + browser.compressedSession()
                window.history.pushState({}, "IGV", url)
            })

        })


</script>

</body>

</html>
</title>
</head>
<body>

</body>
</html>
