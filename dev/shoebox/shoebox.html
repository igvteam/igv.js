<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Seg Big</title>

</head>

<body>

<h1>Shoebox</h1>

<button id="log-state">Log Session</button>
<button id="bookmark">Bookmark</button>

<div id="igvDiv" style="padding-top: 50px;padding-bottom: 20px; height: auto"></div>

<script type="module">

    import igv from "../../js/index.js"

    var options =
        {
            sampleNameViewportWidth: 6,
            genome: "hg38",
            "locus": "chr11:47,376,930-47,380,077",
            "roi": [
                {
                    "name": "ROI regions",
                    "url": "https://storage.googleapis.com/broad-buenrostro-pipeline-genome-annotations/neva/BMMC_roi/BMMC_20celltype_multiscale_roi_regions.bed",
                    "isVisible": false
                }
            ],
            tracks: [
                {
                    "url": "https://storage.googleapis.com/broad-buenrostro-pipeline-genome-annotations/neva/BMMC_roi/NK.bed.gz",
                    "indexURL": "https://storage.googleapis.com/broad-buenrostro-pipeline-genome-annotations/neva/BMMC_roi/NK.bed.gz.tbi",
                    "name": "NK",
                    "format": "bed",
                    "type": "shoebox",
                    "color": "rgb(73, 26, 136)"
                },
                {
                    "url": "https://storage.googleapis.com/broad-buenrostro-pipeline-genome-annotations/neva/BMMC_roi/CLP.bed.gz",
                    "indexURL": "https://storage.googleapis.com/broad-buenrostro-pipeline-genome-annotations/neva/BMMC_roi/CLP.bed.gz.tbi",
                    "name": "CLP",
                    "format": "bed",
                    "type": "shoebox",
                    "color": "rgb(106, 207, 255)"
                },
                {
                    "url": "https://storage.googleapis.com/broad-buenrostro-pipeline-genome-annotations/neva/BMMC_roi/late-Ery.bed.gz",
                    "indexURL": "https://storage.googleapis.com/broad-buenrostro-pipeline-genome-annotations/neva/BMMC_roi/late-Ery.bed.gz.tbi",
                    "name": "late-Ery",
                    "format": "bed",
                    "type": "shoebox",
                    "color": "rgb(137, 17, 0)"
                },
                {
                    "url": "https://storage.googleapis.com/broad-buenrostro-pipeline-genome-annotations/neva/BMMC_roi/CD16mono.bed.gz",
                    "indexURL": "https://storage.googleapis.com/broad-buenrostro-pipeline-genome-annotations/neva/BMMC_roi/CD16mono.bed.gz.tbi",
                    "name": "CD16mono",
                    "format": "bed",
                    "type": "shoebox",
                    "color": "rgb(255, 136, 2)",
                },
                {
                    "url": "https://storage.googleapis.com/broad-buenrostro-pipeline-genome-annotations/neva/BMMC_roi/NaiveB.bed.gz",
                    "indexURL": "https://storage.googleapis.com/broad-buenrostro-pipeline-genome-annotations/neva/BMMC_roi/NaiveB.bed.gz.tbi",
                    "name": "NaiveB",
                    "format": "bed",
                    "type": "shoebox",
                    "color": "rgb(210, 120, 255)"
                }
            ]
        }


    var igvDiv = document.getElementById("igvDiv")

    igv.createBrowser(igvDiv, options)
        .then(function (browser) {
            console.log("Created IGV browser")
            document.getElementById("log-state").addEventListener("click", () => console.log(browser.toJSON()))

            document.getElementById('bookmark').addEventListener('click', () => {
                const path = window.location.href.slice()
                const idx = path.indexOf("?")
                const url = (idx > 0 ? path.substring(0, idx) : path) + "?sessionURL=blob:" + browser.compressedSession()
                window.history.pushState({}, "IGV", url)
            })

        })


</script>

</body>

</html>
</title>
</head>
<body>

</body>
</html>
