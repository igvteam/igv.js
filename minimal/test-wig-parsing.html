<!DOCTYPE html>
<html>
<head>
    <title>WIG Parsing Test</title>
</head>
<body>
    <h1>WIG Parsing Test</h1>
    <div id="output"></div>
    
    <script type="module">
        import { GenomicRegion } from './models/genomicRegion.js'
        import { WigSource } from './data/wigSource.js'
        
        const output = document.getElementById('output')
        
        async function testWigParsing() {
            try {
                console.log('Testing WIG parsing...')
                
                // Test region
                const region = GenomicRegion.parse('chr19:49307000-49308000')
                output.innerHTML += `<p>Region: ${JSON.stringify(region)}</p>`
                
                // Test fixedStep WIG
                console.log('Testing fixedStep WIG...')
                const fixedSource = new WigSource({ url: '../test/data/wig/fixedStep-example.wig' })
                const fixedData = await fixedSource.fetch(region)
                output.innerHTML += `<p>FixedStep data points: ${fixedData.length}</p>`
                if (fixedData.length > 0) {
                    output.innerHTML += `<p>Sample: ${JSON.stringify(fixedData.slice(0, 2))}</p>`
                }
                
                // Test variableStep WIG
                console.log('Testing variableStep WIG...')
                const varSource = new WigSource({ url: '../test/data/wig/variableStep-example.wig' })
                const varData = await varSource.fetch(region)
                output.innerHTML += `<p>VariableStep data points: ${varData.length}</p>`
                if (varData.length > 0) {
                    output.innerHTML += `<p>Sample: ${JSON.stringify(varData.slice(0, 2))}</p>`
                }
                
                console.log('Test completed!')
                
            } catch (error) {
                console.error('Test failed:', error)
                output.innerHTML += `<p style="color: red;">Error: ${error.message}</p>`
            }
        }
        
        testWigParsing()
    </script>
</body>
</html>
