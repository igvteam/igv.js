import "./utils/mockObjects.js"
import {assert} from 'chai'
import {createSupplementaryAlignments} from "../js/bam/supplementaryAlignment.js"

suite("test SA tag", function () {

    test("Supplementary alignments", async function () {

        const sa = '14,50249999,+,3M1D13M4D30M1I8M1I3M2I1M2I4M2I16M1D2M1I3M1I11M1I5M1D7M1D16M1D1M2D18M1D29M1D10M1I9M1I6M1I16M1I63M1D10M1D5M1I7M1D5M1D3M1I39M1D42M1I27M1I1M1D13M1D8M1D7M1I10M1D10M1I40M1D14M1I13M1I14M1D6M1D12M1I12M1I48M1I9M1D2M1D4M1I5M1D10M1I14M1I15M1D4M1I7M1D19M1I11M1I20M1I12M1D5M1I42M1D7M1D16M1D15M1I12M1I11M2D4M1D3M3D12M1D3M1D21M1I19M1D32M1I22M1I4M2D2M1I23M1D2M1D12M2I19M2I2M1D5M1D3M2D40M1I1M1I3M1I4M1D11M1D6M1I11M1D13M2D7M1I10M1I7M1I7M1D3M1I8M1D6M1I2M1D8M1D26M1I3M1I7M1I24M1D5M1I6M1I1M1D29M1I20M1D10M1D23M1D19M1I20M1D10M1D2M1I13M1I1M1I3M3I20M1D24M2I3M1I1M1I14M1D11M1I1M2I17M1I11M1D3M1D12M1I1M1D38M1D14M1I5M1I17M1D10M1D11M1D9M1D23M1I1M1D3M1D2M1D15M1I15M4I6M1I4M1I5M1I11M1I7M1I1M1D6M2D7M1I5M1I17M1I2M1D6M1D27M1D10M1I2M1D11M1I9M1I4M1D7M1I1M1D4M1I3M1I2M1I33M2D3M1I12M2I14M1I6M1I2M1I17M1I9M1D7M1D18M1I10M1I10M2I19M1I8M1I10M1I1M1I6M1I15M1I30M1I4M1I15M1D9M1D2M1I3M1I12M1I2M1I15M1I3M1I12M1I12M1D9M1I1M1I8M1D3M1D10M1I6M1D18M1I1M2I2M1I2M1I12M1D9M1I5M2I15M3I25M1I2M1I23M1I19M2D38M1I2M1D10M1I1M1I9M2D14M1I2M1I16M1D7M1I15M1D5M1I2M1I10M1I3M1D5M1I8M1I4M1D5M1I16M3I12M1D4M1I17M3D20M1D10M1D3M2D12M1I5M1D4M1D21M1D3M1I3M1I4M1D7M1D9M1I2M1I13M1I8M1I12M1I27M1I3M1D9M1D3M1I5M1I6M2I1M1I5M1I18M1I17M1D4M2I12M1D15M2I33M1D2M1D7M1I4M2I5M1I4M1D15M1I13M1D20M1I5M1I3M1I5M1D9M2I3M1D14M1I3M1I16M1I20M1I16M1I6M1I10M2I10M1I9M1I17M1D13M2I8M1I23M1D4M1I33M1I6M1I3M2I6M1I11M1I1M1D5M1I7M1D19M2D7M1I3M1D4M1D6M1D5M1I9M1I40M3I12M1I8M1I11M1D6M1I3M1I7M2I3M1I6M5I8M1I31M1I8M1I9M1I4M1I3M1D12M1D3M1D4M1D4M1I16M1I3M1D12M1I5M2I1M7I21M1D25M1I16M1I9M1D4M1D13M1I5M2I8M1I41M1I3M1D9M1D14M1I4M2D2M1I1M1D2M1I10M1D13M1I17M2I3M1D3M1D9M1I8M1D19M3I2M1D3M1I6M4I2M1I14M1I7M1I5M1I28M1I22M1I4M1I23M1I7M1I2M1D6M1I5M1D7M1D11M2I20M1I6M1D8M1I3M1I9M1I27M2I17M1D41M1D14M1D8M1I11M1I4M1D13M1D18M1I23M1I23M1D20M2I5M1D7M1I5M3I21M1I7M1D12M2D5M1I9M1D9M1I5M1I7M1I2M1I3M2D2M1D9M1I4M1D6M1I3M2I4M1D2M1I1M1D3M2D42M1I22M1I3M2I7M1D14M2I4M1D1M1D8M1I5M1I1M1I3M1I10M1I1M1D9M1I2M1D20M1D7M1D12M1D14M1I3M1I16M1D47M1I3M1I19M1I5M1I15M1I21M2I16M1I2M1D12M1I9M1D16M1I10M1I3M1D32M1I18M1I3M3I3M1I33M1I1M1I1M2I4M1I26M1I33M1I3M1I7M5I18M1I9M1I1M2I2M1I2M1I7M1I25M1I2M1I1M1I2M3I4M2I1M2I18M2I6M1D3M1I2M1I13M1D44M1I9M1I5M1I14M1I7M1I3M1D5M1I3M1I12M1D36M1D3M1I14M1I4M2I17M1I14M1I2M1I6M1I5M1I16M1I26M1D7M1I3M1D8M1D4M1D3M1I12M1I17M1I5M1I2M1D8M1I23M1I15M1I11M2D3M1I3M1D9M1D35M1D14M1I17M1I12M1I15M1I2M1D7M2I14M1I10M1D4M1I12M1I27M1D4M1I2M1D4M1I3M1D8M1I19M1D5M1I1M1I13M1D5M1I16M1I4M1I1M1D38M1I14M1D2M1I5M1I6M1D8M1D4M2D4M1I26M1D4M2I3M1D11M1I6M1I4M1I4M1D10M1D3M1D12M1I13M1I7M1I15M1D6M1I3M1I14M1D5M2I13M1D11M1D11M1I1M1I9M1I29M1I23M2I3M1I20M1I1M1I17M1D5M1I12M2D3M1D5M1I9M1D7M2I24M1I8M1I2M1I8M1I5M1D3M1I8M1I9M1I7M1I5M1I19M1D11M1I15M1I6M1I1M1I17M1I5M1I1M1D15M1I7M1I26M1I5M1D22M1D6M1I8M1D12M1D9M1D14M1D34M1D2M1I27M1I17M1I1M1I14M1I4M7541S,56,812;8,121562251,-,5S27M1I13M1D5M1I40M2I7M1I2M1I18M1D8M1I27M1D9M1D5M1I3M1D11M1I1M1I5M1I6M1I14M1I3M1I1M1I4M3I21M2I56M1I8M1D4M1I10M1I8M2D2M1D6M1I7M1I2M2I5M1D3M1D1M1D5M1I10M1I6M1I16M2I3M2I2M1D13M1I18M1D3M1I5M1I1M2I7M1D17M1I21M1D4M1D19M4I10M1D9M1I3M3I31M1I13M1D8M1I23M1D7M1I2M1I11M1I7M1I5M1D23M1D24M1I53M1D3M1D4M1D4M2D15M1D56M1D8M2I5M1D16M1D10M1I1M1D3M1I18M1I6M1D8M1I15M1D8M1I9M1I7M1I8M1I21M2I5M1I40M1I3M2I3M1D5M1I8M1I3M1D6M1D58M1D7M1D3M1I12M1D18M1D11M1I17M1I7M1D4M1D1M1I32M1D11M3I27M1I32M1I11M1I20M1D1M2I12M1I24M1I12M1D13M1D12M2I15M1I1M1D12M1I14M1D21M1D8M1D4M1D15M1D5M1I10M1D11M1I14M1I15M1I22M1I42M3I25M1I7M1D9M1I14M1I21M1D3M1D2M1I2M1I28M1I5M1I2M1I8M12532S,56,179;8,121564142,-,1987S21M1D7M1I3M1D13M1I3M1I3M1D22M1D6M2I3M1I11M1D13M1I19M1I16M1D4M1I8M1I5M1I2M1I4M1I6M1I2M1I8M1I9M1D10M11I2M3I11M1D16M1I13M1I1M2I2M1D20M1D8M2I9M2I3M1I4M1D5M1I3M1D17M1I19M2D1M1D4M1D4M2I4M1D17M1D20M1I21M2I4M1I13M2I2M1I6M1D33M1I10M2I5M1I18M1I2M2I5M1I10M2I13M1I4M1I2M1I13M1I1M1D10M1I2M2I3M1D7M1I16M1I13M1I3M1I5M1I8M1I14M1I4M1I17M1I3M5I18M1D5M1I17M1I3M1I5M1I12M1I15M2I20M1D23M1I10M3I1M1D7M3I1M1I13M4D5M2I3M1I7M1I13M2I2M1I17M1I21M1I13M2I13M1D14M1D2M1I17M1I14M1I7M1I7M1I16M4I5M1I7M1I6M1I15M1I1M2I2M1I4M1D5M1I1M1D5M4I4M1I3M1D7M1I1M1I5M1I4M1D2M1D21M2I1M1I8M1I4M5I2M1I3M2I1M1I13M1I17M1I2M1D11M1D2M1I10M1I3M2I5M1I5M1I9M1I1M1I4M1D10M1D11M1I11M1I2M2I11M1I11M1I10M1D15M1D8M1D18M1D13M1D1M1D28M2I7M1I3M1I22M1I9M1I2M1I3M2I9M1D6M1D2M1I17M1I3M1I1M1I14M1I2M1I5M2I4M1D8M1I5M1I9M2I13M1I9M1D9M1I5M3I1M1I6M1I18M1D10M2I9M1I2M1I10M1I2M1I27M1I13M1I1M1I1M1I5M1I14M1D10M1D12M1I5M1I15M1D6M1D13M1D17M1I13M2I10M1D7M1D15M2I41M2I4M2I19M1I3M1D5M1I13M1I3M1I15M10312S,56,305;8,123905817,-,4036S4M1I6M1D26M1D8M1D8M1I25M1I1M1D3M1D8M1I9M1I17M1I18M1I3M2I8M1I6M1I14M1I9M1I4M1I5M1I3M1I1M1I12M1I5M1I12M1I16M1I4M1I25M1I1M1I8M1I8M1I1M1D1M1D11M1D4M1I6M1I8M1I5M1I3M4I33M1I13M1I4M1I9M3I4M1I4M2I2M1I21M1I2M6I12M1I2M1I6M2D4M1D2M2I6M1D3M1D4M1I45M1D12M1I5M3I7M1D7M1D4M1D1M1I2M2I11M1I10M1I9M1D6M1D4M1I13M1I5M1D8M1I3M2I2M1I6M1I11M1I2M1I18M1I11M1D1M1D13M1I4M1I1M2I8M1I1M1I8M1D5M1I4M1I8M1D12M2I14M1D22M1I21M1D1M1D11M1I7M1I6M1I8M1D3M1I8M1I15M1D14M1I20M1I10M2I5M1I5M1I5M1D16M1D1M1D3M1I3M1D9M1I8M1I4M2I20M1D4M3I6M1D4M1D8M1I4M1D13M1I3M2I6M1D5M1I10M1I24M1I1M1I13M1I4M2D2M1D2M1D4M1I5M1I1M1I8M1I6M1D12M1I19M1D27M1D13M1D12M1D8M1I14M1I4M1D37M1I3M1D4M1D1M1D12M1D9M1D1M1I2M1I27M1I3M1D4M1I14M1I31M1I3M1I4M1I10M1I21M1I46M1I3M1I32M1D8M1I4M1D4M1D14M1D15M1I28M1D11M1I21M1I2M1D2M1I7M2I4M1I1M1I9M1I1M1I5M1I7M8556S,54,228;8,126480853,+,8385S18M4I1M1I9M1I14M2I4M1D1M1D12M1D5M1I9M1D5M1D2M1D7M1I1M2I35M2I27M5794S,60,21;'
        const supAlignments = createSupplementaryAlignments(sa)
        assert.equal(supAlignments.length, 5)

        const saString = [
            '14:50,249,999-50,256,583 (+) = 6,584bp @MAPQ: 56 NM: 812',
            '8:121,562,251-121,564,007 (-) = 1,756bp @MAPQ: 56 NM: 179',
            '8:121,564,142-121,566,029 (-) = 1,887bp @MAPQ: 56 NM: 305',
            '8:123,905,817-123,907,482 (-) = 1,665bp @MAPQ: 54 NM: 228',
            '8:126,480,853-126,481,009 (+) = 156bp @MAPQ: 60 NM: 21'
        ]

        for(let i=0; i<5; i++) {
            assert.equal(supAlignments[i].printString(), saString[i])
        }

    })


})

